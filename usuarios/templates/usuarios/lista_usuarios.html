{% extends 'base.html' %}
{% load static %}

{% block title %}Gesti√≥n de Usuarios - Sistema Trazabilidad{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/lista_usuarios.css' %}">
{% endblock %}

{% block content %}
<div class="container gestion-usuarios py-3">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold text-primary-hcm mb-1">
                <i class="bi bi-people-fill"></i> Gesti√≥n de Usuarios
            </h2>
            <p class="text-muted small">Administraci√≥n de cuentas del sistema</p>
        </div>
        <a href="{% url 'usuarios:crear_usuario' %}" class="btn btn-new-user">
            <i class="bi bi-person-plus"></i> Nuevo Usuario
        </a>
    </div>

    <!-- üîç BUSCADOR -->
    <div class="d-flex justify-content-end mb-3 w-100">
        <div class="search-wrapper d-flex align-items-center">
            <input
                type="text"
                id="searchUser"
                name="q"
                class="form-control search-input"
                placeholder="Buscar por Nombre, Rut, Rol o Email"
                autocomplete="off"
            >

            <button class="btn btn-search" type="button">
                <i class="bi bi-search"></i>
            </button>

            <i class="bi bi-info-circle ms-2 text-muted"
              data-bs-toggle="tooltip"
              title="Puedes buscar por: RUT, nombre, apellido, rol y correo"></i>
        </div>
    </div>

    <div class="card shadow-sm table-card">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="table-hcm">
                        <tr>
                            <th>RUT</th>
                            <th>Nombre</th>
                            <th>Rol</th>
                            <th>Estado</th>
                            <th>√öltimo Acceso</th>
                            <th class="text-end">Acciones</th>
                        </tr>
                    </thead>

                    <!-- ‚¨áÔ∏è AQUI SE INSERTA AJAX -->
                    <tbody id="tbodyUsuarios">
                        {% include 'usuarios/partials/obtener_usuarios.html' %}
                    </tbody>

                </table>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <a href="{% url 'app:home' %}" class="btn btn-volver">
            <i class="bi bi-arrow-left"></i> Volver al Panel
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/usuarios_busqueda.js' %}"></script>
{% endblock %}